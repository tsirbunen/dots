directive @pollValidation on FIELD_DEFINITION
directive @isPollOwner on FIELD_DEFINITION

enum DataClass {
  TEXT
  NUMBER
  DATE
}

enum PollState {
  EDIT
  VOTE
  CLOSED
}

input CreatePollInput {
  ownerId: ID!
  ownerName: String!
  question: String!
  answers: [String!]!
  isAnonymous: Boolean!
  dataClass: DataClass!
  totalVotesCountMax: Int!
  optionVotesCountMax: Int!
  showStatusWhenVoting: Boolean!
}

input AnswerEditData {
  answerId: ID!
  content: String!
}

input EditPollInput {
  pollId: ID!
  question: String!
  answers: [AnswerEditData]!
  isAnonymous: Boolean!
  dataClass: DataClass!
  totalVotesCountMax: Int!
  optionVotesCountMax: Int!
  showStatusWhenVoting: Boolean!
}

input FindPollInput {
  id: ID
  code: String
}

type Poll {
  id: ID!
  ownerId: ID!
  code: String!
  question: String!
  isAnonymous: Boolean!
  totalVotesCountMax: Int!
  optionVotesCountMax: Int!
  showStatusWhenVoting: Boolean!
  state: PollState!
  token: String
  deletedAt: Timestamp
  createdAt: Timestamp!
  updatedAt: Timestamp!
}

extend type Query {
  findPoll(input: FindPollInput): Poll
}

extend type Mutation {
  createPoll(input: CreatePollInput!): Poll! @pollValidation
  editPoll(input: EditPollInput!): Poll! @isPollOwner
  openPoll(pollId: ID!): Boolean! @isPollOwner
  # closePoll(pollId: ID!)
  # deletePoll(pollId: ID!)
}
